{"version":3,"sources":["components/Board.js","canvas_bg.png","GameState.js","components/Game.js","Utils.js","ZeroAgent.js","PVNet.js","App.js","reportWebVitals.js","index.js"],"names":["CELL_SIZE","useStyles","makeStyles","canvas","backgroundColor","imageBg","Image","boardPosToPixel","row","col","drawStone","context","turn","x","y","beginPath","arc","Math","PI","fillStyle","fill","closePath","stroke","textAlign","textBaseline","fillText","draw","history","getContext","clearRect","width","height","drawImage","i","length","strokeStyle","drawLastStoneIndicator","Board","boardSize","onSelect","classes","canvasRef","useRef","useEffect","current","canvasSize","className","ref","onClick","event","pageX","target","offsetLeft","pageY","offsetTop","floor","src","GameState","this","result","RESULT_NONE","blackStones","Array","whiteStones","isBlackTurn","STONE_BLACK","STONE_WHITE","newInstance","slice","output","push","inputPos","posIndex","checkResult","lastPos","lastPosIndex","pop","lastInputPos","targetStones","targetResult","RESULT_BLACK_WIN","RESULT_WHITE_WIN","sum","winStoneCount","RESULT_DRAW","root","winningRatio","marginTop","outlineStyle","outlineColor","outlineWidth","determinate","color","StyledLinearProgress","withStyles","colorPrimary","barColorPrimary","LinearProgress","Game","gameState","pvnet","onRestart","onUndo","onComputer","useState","setWinningRatio","a","modelInput","getModelInput","asyncForward","modelOutput","value","min","max","Grid","container","justify","item","variant","IconButton","size","sleep","seconds","Promise","resolve","setTimeout","ZeroAgent","numMCTS","ready","rootNode","newNode","curGameState","clone","leafNode","processSelection","processExpansionAndEvaluation","processBackup","maxVisitCount","children","child","n","bestNodeIndex","childPositions","childPriors","parent","w","q","curNode","totalNSquared","sqrt","maxQU","bestChildIndex","childNode","p","qu","bestChildNode","step","policy","validPositions","getValidPositions","numChildren","sumOfP","pos","PVNet","modelPath","model","InferenceSession","backendHint","console","log","loadModel","run","Tensor","Float32Array","input","get","data","curTurn","curColor","getTurnColor","oppColor","curStones","oppStones","curLastStones","oppLastStones","HISTORY_SIZE","colorStones","concat","justifyContent","maxWidth","margin","AppState","text","newGameState","App","appState","setAppState","setGameState","zeroAgent","goToNextState","autoPlay","asyncGetAction","warn","asyncLoadModel","undo","Typography","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8f94465a.chunk.js","sourcesContent":["import React, {useEffect, useRef} from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\n// 이미지 출처: https://tools.w3cub.com/gomoku\r\nimport canvasBg from '../canvas_bg.png'\r\n\r\nconst CELL_SIZE = 30\r\nconst STONE_RADIUS = 12\r\n\r\nconst useStyles = makeStyles({\r\n    canvas: {\r\n        //border: '1px solid black',\r\n        backgroundColor: '#dab050',\r\n    },\r\n})\r\n\r\nconst imageBg = new Image()\r\nimageBg.src = canvasBg\r\n\r\nfunction boardPosToPixel(row, col) {\r\n    let x = CELL_SIZE / 2 + col * CELL_SIZE\r\n    let y = CELL_SIZE / 2 + row * CELL_SIZE\r\n\r\n    return [x, y]\r\n}\r\n\r\nfunction drawStone(context, row, col, turn) {\r\n    let [x, y] = boardPosToPixel(row, col)\r\n\r\n    context.beginPath()\r\n    context.arc(x, y, STONE_RADIUS, 0, 2 * Math.PI)\r\n    context.fillStyle = (turn % 2 === 0) ? 'black' : 'white'\r\n    context.fill()\r\n    context.closePath()        \r\n    context.stroke()\r\n\r\n    context.textAlign = 'center'\r\n    context.textBaseline = 'middle'\r\n    context.fillStyle = (turn % 2 !== 0) ? 'black' : 'white'\r\n    context.fillText(turn + 1, x, y)\r\n}\r\n\r\nfunction drawLastStoneIndicator(context, row, col) {\r\n    let [x, y] = boardPosToPixel(row, col)\r\n\r\n    context.beginPath()\r\n    context.arc(x, y, STONE_RADIUS * 1.4, 0, 2 * Math.PI)\r\n    context.strokeStyle = 'blue'\r\n    context.closePath()        \r\n    context.stroke()\r\n}\r\n\r\nfunction draw(canvas, history) {\r\n    const context = canvas.getContext('2d')\r\n\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    context.drawImage(imageBg, 0, 0, canvas.width, canvas.height)\r\n\r\n    for (let i = 0; i < history.length; ++i)\r\n    {\r\n        let [row, col] = history[i]\r\n        \r\n        drawStone(context, row, col, i)\r\n    }\r\n\r\n    if (0 < history.length) {\r\n        let [row, col] = history[history.length - 1]\r\n        drawLastStoneIndicator(context, row, col)\r\n    }\r\n}\r\n\r\nexport default function Board({boardSize, history, onSelect}) {\r\n    const classes = useStyles()\r\n    const canvasRef = useRef()\r\n\r\n    // componentDidMount()\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current\r\n        \r\n        //const dpi = window.devicePixelRatio\r\n        const dpi = 1\r\n        const canvasSize = CELL_SIZE * boardSize\r\n        canvas.width = canvasSize * dpi\r\n        canvas.height = canvasSize * dpi        \r\n\r\n        // eslint-disable-next-line\r\n    }, [])  \r\n\r\n    useEffect(() => {\r\n        draw(canvasRef.current, history)\r\n    }, [history])\r\n\r\n    function onClick(event) {\r\n        let x = event.pageX - event.target.offsetLeft\r\n        let y = event.pageY - event.target.offsetTop\r\n\r\n        let row = Math.floor(y / CELL_SIZE)\r\n        let col = Math.floor(x / CELL_SIZE)\r\n\r\n        if (onSelect)\r\n        {\r\n            onSelect([row, col])\r\n        }\r\n    }\r\n   \r\n    return (\r\n        <div>\r\n            <canvas className={classes.canvas} ref={canvasRef} onClick={onClick}/>\r\n        </div>\r\n    )\r\n}","export default \"data:image/png;base64,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1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4Wnyx5+4+7+7L6H3y8fHx8U0eH9+7fc8N99z+A/Lx8fHx7R0f37t9zw333DaQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2Dpw1fdxv7v+eXf/urvf7u6Xd4J+0ur7fYuvter7OPt4RXytVd/H2ccrWvfNAxd9v97dP+7u6w/u1ze6ftTi+/05vtaizz5eF19r0Wcfr2vdNw9c833cz8fx7T7eZPtRa+/3fXytNd/H2ccr42ut+T7OPl7Zum8euOb77f7zOL7+8Tcrrb3f9/G11nz28dr4Wms++3ht67577u7z7r6M3ueY76++fXy9339Tf7dz9f34/rd99sG3dGs++3i977nhntt/wCWfgfAt3ZrPPviWbs1nH6/3PTfcc9vANd9/8y/eJe/a+30fX2vNZx+vja+15rOP17bumweu+T7urwfyt3fhftDa+30fX2vN93H28cr4Wmu+j7OPV7bumwcu+r7cz8fx9ze6ftTi+/05vtaizz5eF19r0Wcfr2vdNw9c9f1yv7u+3t2///i89M3jW6vv9y2+1qrPPl4TX2vVZx+vad03D+Rr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy/23N3n3X0ZvU8+Pj4+vsnj43u377nhntt/QD4+Pj6+vePje7fvueGe2wbytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXe+7u8+6+jN4nHx8fH9/k8fG92/fccM/tPyAfHx8f397x8b3b99xwz20D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfi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\"","class GameState {\r\n\r\n    static STONE_BLACK = 1\r\n    static STONE_WHITE = -1\r\n\r\n    static RESULT_NONE = 99\r\n    static RESULT_BLACK_WIN = GameState.STONE_BLACK\r\n    static RESULT_WHITE_WIN = GameState.STONE_WHITE\r\n    static RESULT_DRAW = 0\r\n\r\n    static isBlackTurn(turn) {\r\n        return (turn % 2 === 0)\r\n    }\r\n\r\n    static getTurnColor(turn) {\r\n        return GameState.isBlackTurn(turn) ? GameState.STONE_BLACK : GameState.STONE_WHITE\r\n    }\r\n\r\n    constructor({boardSize}) {\r\n        this.boardSize = boardSize\r\n\r\n        this.turn = 0\r\n        this.result = GameState.RESULT_NONE\r\n        this.blackStones = new Array(boardSize * boardSize).fill(0)\r\n        this.whiteStones = new Array(boardSize * boardSize).fill(0)\r\n        this.history = []\r\n    }\r\n\r\n    clone() {\r\n        let newInstance = new GameState({ boardSize: this.boardSize })\r\n\r\n        newInstance.turn = this.turn\r\n        newInstance.result = this.result\r\n        newInstance.blackStones = this.blackStones.slice()\r\n        newInstance.whiteStones = this.whiteStones.slice()\r\n        newInstance.history = this.history.slice()\r\n\r\n        return newInstance\r\n    }\r\n\r\n    getValidPositions() {\r\n        let output = []\r\n\r\n        for (let i = 0; i < this.boardSize * this.boardSize; ++i) {\r\n            if (this.blackStones[i] === 0 && this.whiteStones[i] === 0) {\r\n                output.push([Math.floor(i / this.boardSize), i % this.boardSize])\r\n            }\r\n        }\r\n\r\n        return output\r\n    }\r\n\r\n    step(inputPos) {\r\n        let posIndex = inputPos[0] * this.boardSize + inputPos[1]\r\n\r\n        if (this.blackStones[posIndex] === 1 || this.whiteStones[posIndex] === 1) {\r\n            return false\r\n        }\r\n\r\n        if (GameState.isBlackTurn(this.turn)) {\r\n            this.blackStones[posIndex] = 1\r\n        } else {\r\n            this.whiteStones[posIndex] = 1\r\n        }\r\n\r\n        this.history.push(inputPos)\r\n        this.turn = this.turn + 1\r\n        this.result = this.checkResult(inputPos)\r\n\r\n        return true\r\n    }\r\n\r\n    undo() {\r\n        if (0 < this.turn) {\r\n            let lastPos = this.history[this.history.length - 1]\r\n            let lastPosIndex = lastPos[0] * this.boardSize + lastPos[1]\r\n\r\n            this.turn = this.turn - 1\r\n            this.blackStones[lastPosIndex] = 0\r\n            this.whiteStones[lastPosIndex] = 0\r\n            this.history.pop()\r\n\r\n            return true\r\n        }\r\n        else {\r\n            return false\r\n        }\r\n    }\r\n\r\n    checkResult(lastInputPos) {\r\n        let targetStones, targetResult\r\n        if (GameState.isBlackTurn(this.turn - 1)) {\r\n            targetStones = this.blackStones\r\n            targetResult = GameState.RESULT_BLACK_WIN\r\n        } else {\r\n            targetStones = this.whiteStones\r\n            targetResult = GameState.RESULT_WHITE_WIN\r\n        }\r\n\r\n        const winStoneCount = 5\r\n\r\n        // 가로 방향\r\n\t\t{\r\n\t\t\tlet row = lastInputPos[0]\r\n\t\t\tlet col = lastInputPos[1] - winStoneCount + 1\r\n\t\t\tlet sum = 0\r\n\t\t\tfor (let i = 0; i < winStoneCount * 2 - 1; ++i) {\r\n\t\t\t\tif (0 <= col && col < this.boardSize && targetStones[row*this.boardSize + col] === 1) {\r\n\t\t\t\t\tif (++sum === winStoneCount) {\r\n\t\t\t\t\t\treturn targetResult\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsum = 0\r\n\t\t\t\t}\r\n\r\n\t\t\t\t++col\r\n\t\t\t}\r\n        }\r\n        \r\n        // 세로방향\r\n\t\t{\r\n\t\t\tlet row = lastInputPos[0] - winStoneCount + 1\r\n\t\t\tlet col = lastInputPos[1]\r\n\t\t\tlet sum = 0\r\n\t\t\tfor (let i = 0; i < winStoneCount * 2 - 1; ++i) {\r\n\t\t\t\tif (0 <= row && row < this.boardSize && targetStones[row*this.boardSize + col] === 1) {\r\n\t\t\t\t\tif (++sum === winStoneCount) {\r\n\t\t\t\t\t\treturn targetResult\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsum = 0\r\n\t\t\t\t}\r\n\r\n\t\t\t\t++row\r\n\t\t\t}\t\t\t\r\n        }\r\n        \r\n        // 대각선 위 방향\r\n\t\t{\r\n\t\t\tlet row = lastInputPos[0] + winStoneCount - 1\r\n\t\t\tlet col = lastInputPos[1] - winStoneCount + 1\r\n\t\t\tlet sum = 0\r\n\t\t\tfor (let i = 0; i < winStoneCount * 2 - 1; ++i) {\r\n\t\t\t\tif (0 <= row && row < this.boardSize && 0 <= col && col < this.boardSize &&\r\n\t\t\t\t\ttargetStones[row*this.boardSize + col] === 1) {\r\n\r\n\t\t\t\t\tif (++sum === winStoneCount) {\r\n\t\t\t\t\t\treturn targetResult\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsum = 0\r\n\t\t\t\t}\r\n\r\n\t\t\t\t--row\r\n\t\t\t\t++col\r\n\t\t\t}\r\n        }\r\n        \r\n        // 대각선 아래 방향\r\n\t\t{\r\n\t\t\tlet row = lastInputPos[0] - winStoneCount + 1\r\n\t\t\tlet col = lastInputPos[1] - winStoneCount + 1\r\n\t\t\tlet sum = 0\r\n\t\t\tfor (let i = 0; i < winStoneCount * 2 - 1; ++i) {\r\n\t\t\t\tif (0 <= row && row < this.boardSize && 0 <= col && col < this.boardSize &&\r\n\t\t\t\t\ttargetStones[row*this.boardSize + col] === 1) {\r\n\r\n\t\t\t\t\tif (++sum === winStoneCount) {\r\n\t\t\t\t\t\treturn targetResult\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsum = 0\r\n\t\t\t\t}\r\n\r\n\t\t\t\t++row\r\n\t\t\t\t++col\r\n\t\t\t}\r\n        }\r\n        \r\n        // 비김\r\n        if (this.boardSize * this.boardSize <= this.turn) {\r\n            return GameState.RESULT_DRAW\r\n        }\r\n\r\n        return GameState.RESULT_NONE\r\n    }\r\n}\r\n\r\nexport default GameState","import React, { useEffect, useState } from 'react'\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles'\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Board from './Board'\r\nimport ComputerIcon from '@material-ui/icons/Computer'\r\nimport UndoIcon from '@material-ui/icons/Undo'\r\nimport ReplayIcon from '@material-ui/icons/Replay'\r\n\r\nimport GameState from '../GameState'\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n    },\r\n    winningRatio: {\r\n        width: '200px',\r\n        height: '15px',\r\n        marginTop: '8px',\r\n        outlineStyle: 'solid',\r\n        outlineColor: 'black',\r\n        outlineWidth: 'thin',\r\n        determinate: {\r\n            color: 'red',\r\n        }\r\n    },\r\n})\r\n\r\nconst StyledLinearProgress = withStyles({\r\n    colorPrimary: {\r\n        backgroundColor: \"white\"\r\n    },\r\n    barColorPrimary: {\r\n        backgroundColor: \"black\"\r\n    }\r\n})(LinearProgress)\r\n\r\nexport default function Game({\r\n    gameState,\r\n    pvnet,\r\n    onSelect,\r\n    onRestart,\r\n    onUndo,\r\n    onComputer,\r\n}) {\r\n    const classes = useStyles()\r\n\r\n    const [winningRatio, setWinningRatio] = useState(50)\r\n\r\n    useEffect(() => {\r\n        if (gameState.result === GameState.RESULT_BLACK_WIN) {\r\n            setWinningRatio(100)\r\n        } else if (gameState.result === GameState.RESULT_WHITE_WIN) {\r\n            setWinningRatio(0)\r\n        } else if (gameState.result === GameState.RESULT_DRAW) {\r\n            setWinningRatio(50)\r\n        } else {\r\n            (async () => {\r\n                const modelInput = pvnet.getModelInput(gameState)\r\n                const modelOutput = await pvnet.asyncForward(modelInput)\r\n                if (modelOutput) {\r\n                    let value = modelOutput.value\r\n                    if (!GameState.isBlackTurn(gameState.turn)) {\r\n                        value *= -1.0\r\n                    }\r\n\r\n                    value = Math.floor((value * 0.5 + 0.5) * 100)\r\n                    value = Math.min(Math.max(value, 1), 99)\r\n\r\n                    setWinningRatio(value)\r\n                }\r\n            })()\r\n        }\r\n\r\n        // eslint-disable-next-line\r\n    }, [gameState.history])\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <Grid container justify='space-between'>\r\n                <Grid item>\r\n                    {(0 < gameState.turn) && <StyledLinearProgress\r\n                        className={classes.winningRatio}\r\n                        variant=\"determinate\"\r\n                        value={winningRatio} />}\r\n                </Grid>\r\n                <Grid item>\r\n                    <Grid container justify='flex-end'>\r\n                        <IconButton size='small' onClick={() => onRestart()}>\r\n                            <ReplayIcon />\r\n                        </IconButton>\r\n                        <IconButton size='small' onClick={() => onUndo()}>\r\n                            <UndoIcon />\r\n                        </IconButton>\r\n                        <IconButton size='small' onClick={() => onComputer()}>\r\n                            <ComputerIcon />\r\n                        </IconButton>\r\n                    </Grid>\r\n                </Grid>\r\n            </Grid>\r\n            <Board\r\n                boardSize={gameState.boardSize}\r\n                history={gameState.history}\r\n                onSelect={onSelect}>\r\n            </Board>\r\n        </div>\r\n    )\r\n}","async function sleep(seconds) {\r\n    return new Promise((resolve) => (setTimeout(resolve, seconds * 1000)))\r\n}\r\n\r\nexport { sleep }","import GameState from './GameState'\r\nimport {sleep} from './Utils'\r\n\r\nclass ZeroAgent {\r\n    constructor({boardSize, pvnet}) {\r\n        this.boardSize = boardSize\r\n        this.pvnet = pvnet\r\n        this.numMCTS = 25\r\n    }\r\n\r\n    async asyncGetAction(gameState) {\r\n        if (!this.pvnet.ready)\r\n        {\r\n            return\r\n        }\r\n\r\n        let rootNode = this.newNode()\r\n\r\n        for (let i = 0; i < this.numMCTS + 1; ++i) {\r\n            let curGameState = gameState.clone()\r\n\r\n            let leafNode = this.processSelection(rootNode, curGameState)\r\n            if (leafNode.result === GameState.RESULT_NONE) {\r\n                await this.processExpansionAndEvaluation(leafNode, curGameState)\r\n            }\r\n            this.processBackup(leafNode)\r\n\r\n            // ui가 갱신될 수 있도록 yield합니다.\r\n            await sleep(0.01)\r\n        }\r\n\r\n        let maxVisitCount = -1\r\n        let bestNodeIndex\r\n        for (let i = 0; i < rootNode.children.length; ++i) {\r\n            let child = rootNode.children[i]\r\n            if (child && maxVisitCount < child.n) {\r\n                maxVisitCount = child.n\r\n                bestNodeIndex = i\r\n            }\r\n        }\r\n\r\n        return rootNode.childPositions[bestNodeIndex]\r\n    }\r\n\r\n    newNode() {\r\n        return {\r\n            children: [],\r\n            childPositions: [],\r\n            childPriors: [],\r\n            parent: null,\r\n            result: GameState.RESULT_NONE,\r\n            value: 0.0,\r\n            n: 0,\r\n            w: 0.0,\r\n            q: 0.0,\r\n        }\r\n    }\r\n\r\n    processSelection(rootNode, curGameState) {\r\n        let curNode = rootNode\r\n\r\n        while (0 < curNode.n) {\r\n            if (curNode.result !== GameState.RESULT_NONE) {\r\n                break\r\n            }\r\n\r\n            let totalNSquared = Math.sqrt(curNode.n)\r\n            \r\n            let maxQU = 0.0\r\n            let bestChildIndex = -1\r\n            for (let i = 0; i < curNode.children.length; ++i) {\r\n                let childNode = curNode.children[i]\r\n                let p = curNode.childPriors[i]\r\n                \r\n                let q = 0.0\r\n                let n = 0\r\n                if (childNode) {\r\n                    q = childNode.q\r\n                    n = childNode.n\r\n                }\r\n\r\n                const c_puct = 5\r\n                let u = c_puct * p * totalNSquared / (n + 1)\r\n                let qu = q + u\r\n\r\n                if (bestChildIndex === -1 || maxQU < qu)\r\n                {\r\n                    maxQU = qu\r\n                    bestChildIndex = i\r\n                }\r\n            }\r\n\r\n            let bestChildNode = curNode.children[bestChildIndex]\r\n            if (!bestChildNode) {\r\n                bestChildNode = this.newNode()\r\n                bestChildNode.parent = curNode\r\n                curNode.children[bestChildIndex] = bestChildNode\r\n            }\r\n\r\n            curGameState.step(curNode.childPositions[bestChildIndex])\r\n            bestChildNode.result = curGameState.result\r\n            if (bestChildNode.result !== GameState.RESULT_NONE) {\r\n                bestChildNode.value = 1.0\r\n            }\r\n\r\n            curNode = bestChildNode\r\n        }\r\n\r\n        return curNode\r\n    }\r\n\r\n    async processExpansionAndEvaluation(leafNode, curGameState) {\r\n        let modelInput = this.pvnet.getModelInput(curGameState)\r\n        let {policy, value} = await this.pvnet.asyncForward(modelInput)\r\n\r\n        let validPositions = curGameState.getValidPositions()\r\n        let numChildren = validPositions.length\r\n\r\n        leafNode.children = new Array(numChildren)\r\n        leafNode.childPositions = new Array(numChildren)\r\n        leafNode.childPriors = new Array(numChildren)\r\n\r\n        let sumOfP = 0.0\r\n        for (let i = 0; i < numChildren; ++i) {\r\n            let pos = validPositions[i]\r\n            let posIndex = pos[0] * this.boardSize + pos[1]\r\n\r\n            leafNode.childPositions[i] = pos\r\n            leafNode.childPriors[i] = policy[posIndex]\r\n            \r\n            sumOfP += policy[posIndex]\r\n        }\r\n\r\n        for (let i = 0; i < numChildren; ++i) {\r\n            leafNode.childPriors[i] /= sumOfP\r\n        }\r\n\r\n        leafNode.value = value * -1.0\r\n    }\r\n\r\n    processBackup(leafNode) {\r\n        let value = leafNode.value\r\n\r\n        let curNode = leafNode\r\n        while (curNode) {\r\n            curNode.n += 1\r\n            curNode.w += value\r\n            curNode.q = curNode.w / curNode.n\r\n\r\n            curNode = curNode.parent\r\n            value *= -1.0\r\n\r\n        }\r\n    }\r\n}\r\n\r\nexport default ZeroAgent","import { Tensor, InferenceSession } from 'onnxjs'\r\n\r\nimport GameState from './GameState'\r\n\r\nconst NUM_INPUT_PLANES = 5\r\nconst HISTORY_SIZE = 5\r\n\r\nclass PVNet {\r\n    constructor({boardSize, modelPath}) {\r\n        this.boardSize = boardSize\r\n        this.modelPath = modelPath\r\n        this.ready = false\r\n    }\r\n\r\n    async asyncLoadModel() {\r\n        const model = new InferenceSession({ backendHint: 'webgl' })\r\n\r\n        console.log(\"Loading model:\", this.modelPath)\r\n        await model.loadModel(this.modelPath)\r\n\r\n        console.log(\"Model warming up...\")\r\n        await model.run([\r\n            new Tensor(\r\n                new Float32Array(1 * NUM_INPUT_PLANES * this.boardSize * this.boardSize),\r\n                'float32',\r\n                [1, NUM_INPUT_PLANES, this.boardSize, this.boardSize])   \r\n        ])\r\n\r\n        this.model = model\r\n        this.ready = true\r\n        console.log(\"Model was successfully loaded.\")\r\n    }\r\n\r\n    async asyncForward(input) {\r\n        if (!this.ready)\r\n        {\r\n            return\r\n        }\r\n\r\n        const modelOutput = await this.model.run([input])\r\n        const policy = modelOutput.get('policy').data\r\n        const value = modelOutput.get('value').data[0]\r\n\r\n        return { policy: policy, value: value}\r\n    }\r\n\r\n    getModelInput(gameState) {\r\n        let curTurn = gameState.turn\r\n        let curColor = GameState.getTurnColor(curTurn)\r\n        let oppColor = GameState.getTurnColor(curTurn + 1)\r\n\r\n        let curStones = curColor === GameState.STONE_BLACK ? gameState.blackStones : gameState.whiteStones\r\n        let oppStones = oppColor === GameState.STONE_BLACK ? gameState.blackStones : gameState.whiteStones\r\n\r\n        let curLastStones = new Array(this.boardSize * this.boardSize).fill(0)\r\n        let oppLastStones = new Array(this.boardSize * this.boardSize).fill(0)\r\n        for (let i = 0; i < HISTORY_SIZE * 2; ++i) {\r\n            let turn = (curTurn - 1) - i\r\n            if (0 <= turn) {\r\n                let inputPos = gameState.history[turn]\r\n                let lastStones = (i % 2) !== 0 ? curLastStones : oppLastStones\r\n                lastStones[inputPos[0] * this.boardSize + inputPos[1]] = 1\r\n            }\r\n            else {\r\n                break\r\n            }\r\n        }\r\n\r\n        let colorStones = new Array(this.boardSize * this.boardSize)\r\n        if (GameState.isBlackTurn(curTurn)) {\r\n            colorStones.fill(0)\r\n        } else  {\r\n            colorStones.fill(1)\r\n        }\r\n\r\n        return new Tensor(\r\n            curStones.concat(oppStones, curLastStones, oppLastStones, colorStones),\r\n            'float32',\r\n            [1, NUM_INPUT_PLANES, this.boardSize, this.boardSize])\r\n    }\r\n}\r\n\r\nexport default PVNet","import 'fontsource-roboto'\n\nimport React, { useEffect, useState } from 'react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport Grid from '@material-ui/core/Grid'\nimport Typography from '@material-ui/core/Typography'\n\nimport Game from './components/Game'\nimport GameState from './GameState'\nimport ZeroAgent from './ZeroAgent'\nimport PVNet from './PVNet'\nimport {sleep} from './Utils'\n\nconst useStyles = makeStyles({\n    root: {\n        justifyContent:'center',\n        maxWidth: '100%',\n        margin: '5vh',\n    },\n})\n\nconst BOARD_SIZE = 15\n\nconst AppState = {\n    DEFAULT: { text: \"\" },\n    MODEL_LOADING: { text: \"모델을 로딩하고 있습니다. 잠시 기다려 주세요.\" },\n    WAITING_FOR_INPUT: { text: \"원하는 위치를 터치하거나 컴퓨터 아이콘을 누르세요.\" },\n    AGENT_THINKING: { text: \"AI가 다음 수를 계산하고 있습니다...\" },\n    GAME_FINISHED: { text: \"대국이 종료되었습니다. 다시 시작 버튼을 누르세요.\" }\n}\n\nfunction newGameState() {\n    return new GameState({\n        boardSize: BOARD_SIZE,\n    })\n}\n\nfunction App() {\n    const [appState, setAppState] = useState(AppState.DEFAULT)\n    const [gameState, setGameState] = useState(newGameState())\n    const [pvnet] = useState(new PVNet({\n        boardSize: BOARD_SIZE,\n        modelPath: './trained_model.onnx',\n    }))\n    const [zeroAgent] = useState(new ZeroAgent({\n        boardSize: BOARD_SIZE,\n        pvnet: pvnet,\n    }))\n\n    function goToNextState(curGameState, inputPos, autoPlay) {\n        let newGameState = curGameState.clone()\n        if (newGameState.step(inputPos)) {\n            setGameState(newGameState)\n\n            if (newGameState.result === GameState.RESULT_NONE) {\n                if (autoPlay) {\n                    (async () => {\n                        await sleep(1.0)\n                        let pos = await zeroAgent.asyncGetAction(newGameState)\n                        if (pos) {\n                            goToNextState(newGameState, pos)\n                        }\n                        else {\n                            console.warn(\"asyncGetAction() failed\")\n                        }\n                    })()\n                    setAppState(AppState.AGENT_THINKING)                    \n                } else {\n                    setAppState(AppState.WAITING_FOR_INPUT)\n                }\n            }\n            else {\n                setAppState(AppState.GAME_FINISHED)\n            }\n        }\n        else {\n            setAppState(AppState.WAITING_FOR_INPUT)\n        }\n    }\n\n    // componentDidMount()\n    useEffect(() => {\n        (async () => {\n            setAppState(AppState.MODEL_LOADING)\n            await pvnet.asyncLoadModel()\n\n            setAppState(AppState.WAITING_FOR_INPUT)\n        })()\n\n        // eslint-disable-next-line\n    }, [])\n\n    function onSelect(pos) {\n        if (appState === AppState.WAITING_FOR_INPUT) {\n            goToNextState(gameState, pos, true)\n        }\n    }\n\n    function onRestart() {\n        if (appState === AppState.WAITING_FOR_INPUT || appState === AppState.GAME_FINISHED) {\n            setGameState(newGameState())\n            setAppState(AppState.WAITING_FOR_INPUT)\n        }\n    }\n\n    function onUndo() {\n        if (appState === AppState.WAITING_FOR_INPUT || appState === AppState.GAME_FINISHED) {\n            let newGameState = gameState.clone()\n            if (newGameState.undo()) {\n                setGameState(newGameState)\n                setAppState(AppState.WAITING_FOR_INPUT)\n            }\n        }\n    }\n\n    function onComputer() {\n        if (appState === AppState.WAITING_FOR_INPUT) {\n            (async () => {\n                let pos = await zeroAgent.asyncGetAction(gameState)\n                if (pos) {\n                    goToNextState(gameState, pos)\n                }\n                else {\n                    console.warn(\"asyncGetAction() failed\")\n                }\n            })()\n            setAppState(AppState.AGENT_THINKING)\n        }\n    }\n\n    const classes = useStyles()\n    return (\n        <div>\n            <Grid className={classes.root} container>\n                <Grid item>\n                    <Game\n                        gameState={gameState}\n                        pvnet={pvnet}\n                        onSelect={onSelect}\n                        onRestart={onRestart}\n                        onUndo={onUndo}\n                        onComputer={onComputer}>\n                    </Game>\n                    <Typography color=\"textPrimary\">\n                        {appState.text}\n                    </Typography>\n                </Grid>\n            </Grid>\n        </div>\n    )\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}