{"version":3,"sources":["canvas_bg.png","components/Board.js","GameState.js","components/Game.js","components/Readme.js","Utils.js","ZeroAgent.js","PVNet.js","App.js","reportWebVitals.js","index.js"],"names":["CELL_SIZE","useStyles","makeStyles","canvas","backgroundColor","imageBgCached","Image","boardPosToPixel","row","col","drawStone","context","turn","x","y","beginPath","arc","Math","PI","fillStyle","fill","closePath","stroke","textAlign","textBaseline","fillText","draw","history","policy","boardSize","getContext","clearRect","width","height","drawImage","i","length","strokeStyle","drawLastStoneIndicator","floor","p","find","pos","size","Board","onSelect","classes","canvasRef","useRef","useState","ready","setReady","useEffect","current","canvasSize","imageBg","onload","src","canvasBg","className","ref","onClick","event","pageX","target","offsetLeft","pageY","offsetTop","GameState","this","result","RESULT_NONE","blackStones","Array","whiteStones","isBlackTurn","STONE_BLACK","STONE_WHITE","newInstance","slice","output","push","inputPos","posIndex","checkResult","lastPos","lastPosIndex","pop","lastInputPos","targetStones","targetResult","RESULT_BLACK_WIN","RESULT_WHITE_WIN","sum","winStoneCount","RESULT_DRAW","root","winningRatio","outlineStyle","outlineColor","outlineWidth","determinate","color","aiLevel","minWidth","StyledLinearProgress","withStyles","colorPrimary","barColorPrimary","LinearProgress","Game","gameState","pvnet","onRestart","onUndo","onComputer","onAILevel","setWinningRatio","setPolicy","setAILevel","a","modelInput","getModelInput","asyncForward","modelOutput","policies","value","values","min","max","Grid","container","justify","alignItems","item","xs","variant","Select","onChange","e","MenuItem","IconButton","theme","heading","fontSize","typography","pxToRem","fontWeight","fontWeightRegular","linebreak","whiteSpace","SimpleExpansionPanel","Accordion","AccordionSummary","expandIcon","aria-controls","id","Typography","AccordionDetails","source","isMobileOnly","isMobileOnlyImported","sleep","seconds","Promise","resolve","setTimeout","ZeroAgent","level","numSimulations","rootNode","newNode","inferences","curGameState","clone","processInferences","leafNode","processSelection","processBackup","maxVisitCount","children","child","n","bestNodeIndex","childPositions","childPriors","parent","w","q","virtualLoss","force","maxInferenceQueueSize","reduce","concat","promise","processExpansionAndEvaluation","splice","curNode","totalNSquared","sqrt","maxQU","bestChildIndex","childNode","qu","bestChildNode","step","validPositions","getValidPositions","numChildren","sumOfP","BATCH_SIZE","PVNet","modelPath","model","session","backendHint","InferenceSession","console","log","loadModel","run","Tensor","Float32Array","input","batchSize","dims","planeSize","policyOutput","get","data","valueOutput","gameStates","colorPlanes","batchBuffer","curTurn","curColor","getTurnColor","oppColor","curStones","oppStones","curLastStones","oppLastStones","j","HISTORY_SIZE","justifyContent","maxWidth","margin","revision","AppState","text","newGameState","App","appState","setAppState","setGameState","zeroAgent","getComputerAction","startTime","performance","now","asyncGetAction","endTime","setAiThinkTime","goToNextState","autoPlay","warn","asyncLoadModel","aiThinkTime","window","onnx","backend","webgl","glContext","version","AppBar","position","Toolbar","Container","process","undo","setLevel","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.79a66080.chunk.js","sourcesContent":["export default \"data:image/png;base64,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1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4WnyxdSBfi6/F1+Jr8bX4Wnyx5+4+7+7L6H3y8fHx8U0eH9+7fc8N99z+A/Lx8fHx7R0f37t9zw333DaQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2DqQr8XX4mvxtfhafC2+2Dpw1fdxv7v+eXf/urvf7u6Xd4J+0ur7fYuvter7OPt4RXytVd/H2ccrWvfNAxd9v97dP+7u6w/u1ze6ftTi+/05vtaizz5eF19r0Wcfr2vdNw9c833cz8fx7T7eZPtRa+/3fXytNd/H2ccr42ut+T7OPl7Zum8euOb77f7zOL7+8Tcrrb3f9/G11nz28dr4Wms++3ht67577u7z7r6M3ueY76++fXy9339Tf7dz9f34/rd99sG3dGs++3i977nhntt/wCWfgfAt3ZrPPviWbs1nH6/3PTfcc9vANd9/8y/eJe/a+30fX2vNZx+vja+15rOP17bumweu+T7urwfyt3fhftDa+30fX2vN93H28cr4Wmu+j7OPV7bumwcu+r7cz8fx9ze6ftTi+/05vtaizz5eF19r0Wcfr2vdNw9c9f1yv7u+3t2///i89M3jW6vv9y2+1qrPPl4TX2vVZx+vad03D+Rr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy+2DuRr8bX4WnwtvhZfiy/23N3n3X0ZvU8+Pj4+vsnj43u377nhntt/QD4+Pj6+vePje7fvueGe2wbytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXWwfytfhafC2+Fl+Lr8UXe+7u8+6+jN4nHx8fH9/k8fG92/fccM/tPyAfHx8f397x8b3b99xwz20D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfii60D+Vp8Lb4WX4uvxdfi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\"","import React, {useState, useEffect, useRef} from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\n// 이미지 출처: https://tools.w3cub.com/gomoku\r\nimport canvasBg from '../canvas_bg.png'\r\n\r\nconst CELL_SIZE = 30\r\nconst STONE_RADIUS = 12\r\n\r\nconst useStyles = makeStyles({\r\n    canvas: {\r\n        //border: '1px solid black',\r\n        backgroundColor: '#dab050',\r\n    },\r\n})\r\n\r\nconst imageBgCached = new Image()\r\nimageBgCached.src = canvasBg\r\n\r\nfunction boardPosToPixel(row, col) {\r\n    let x = CELL_SIZE / 2 + col * CELL_SIZE\r\n    let y = CELL_SIZE / 2 + row * CELL_SIZE\r\n\r\n    return [x, y]\r\n}\r\n\r\nfunction drawStone(context, row, col, turn) {\r\n    let [x, y] = boardPosToPixel(row, col)\r\n\r\n    context.beginPath()\r\n    context.arc(x, y, STONE_RADIUS, 0, 2 * Math.PI)\r\n    context.fillStyle = (turn % 2 === 0) ? 'black' : 'white'\r\n    context.fill()\r\n    context.closePath()        \r\n    context.stroke()\r\n\r\n    context.textAlign = 'center'\r\n    context.textBaseline = 'middle'\r\n    context.fillStyle = (turn % 2 !== 0) ? 'black' : 'white'\r\n    context.fillText(turn + 1, x, y)\r\n}\r\n\r\nfunction drawLastStoneIndicator(context, row, col) {\r\n    let [x, y] = boardPosToPixel(row, col)\r\n\r\n    context.beginPath()\r\n    context.arc(x, y, STONE_RADIUS * 1.4, 0, 2 * Math.PI)\r\n    context.strokeStyle = 'blue'\r\n    context.closePath()        \r\n    context.stroke()\r\n}\r\n\r\nfunction draw(canvas, history, policy, boardSize) {\r\n    const context = canvas.getContext('2d')\r\n\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    context.drawImage(imageBgCached, 0, 0, canvas.width, canvas.height)\r\n\r\n    // stone\r\n    for (let i = 0; i < history.length; ++i)\r\n    {\r\n        let [row, col] = history[i]\r\n        \r\n        drawStone(context, row, col, i)\r\n    }\r\n\r\n    // last stone indicator\r\n    if (0 < history.length) {\r\n        let [row, col] = history[history.length - 1]\r\n        drawLastStoneIndicator(context, row, col)\r\n    }\r\n\r\n    // policy\r\n    if (policy) {\r\n        for (let i = 0; i < policy.length; ++i)\r\n        {\r\n            let row = Math.floor(i / boardSize)\r\n            let col = i % boardSize\r\n            let [x, y] = boardPosToPixel(row, col)\r\n\r\n            let p = Math.floor(policy[i] * 100.0)\r\n            if (0 < p && !history.find((pos) => (pos[0] === row && pos[1] === col))) {\r\n                let size = p/100 * STONE_RADIUS + 5\r\n                context.fillStyle = 'red'\r\n                context.fillStyle = 'rgba(255, 0, 0, 0.5)'\r\n                context.beginPath()\r\n                context.arc(x, y, size, 0, 2 * Math.PI)\r\n                context.closePath()        \r\n                context.fill()\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default function Board({boardSize, history, policy, onSelect}) {\r\n    const classes = useStyles()\r\n    const canvasRef = useRef()\r\n    const [ready, setReady] = useState(false)\r\n\r\n    // componentDidMount()\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current\r\n        \r\n        //const dpi = window.devicePixelRatio\r\n        const dpi = 1\r\n        const canvasSize = CELL_SIZE * boardSize\r\n        canvas.width = canvasSize * dpi\r\n        canvas.height = canvasSize * dpi\r\n\r\n        const imageBg = new Image()\r\n        imageBg.onload = () => { setReady(true) }\r\n        imageBg.src = canvasBg\r\n\r\n        // eslint-disable-next-line\r\n    }, [])  \r\n\r\n    useEffect(() => {\r\n        if (ready) {\r\n            draw(canvasRef.current, history, policy, boardSize)\r\n        }\r\n    }, [ready, history, policy, boardSize])\r\n\r\n    function onClick(event) {\r\n        let x = event.pageX - event.target.offsetLeft\r\n        let y = event.pageY - event.target.offsetTop\r\n\r\n        let row = Math.floor(y / CELL_SIZE)\r\n        let col = Math.floor(x / CELL_SIZE)\r\n\r\n        if (onSelect)\r\n        {\r\n            onSelect([row, col])\r\n        }\r\n    }\r\n   \r\n    return (\r\n        <div>\r\n            <canvas className={classes.canvas} ref={canvasRef} onClick={onClick}/>\r\n        </div>\r\n    )\r\n}","class GameState {\r\n\r\n    static STONE_BLACK = 1\r\n    static STONE_WHITE = -1\r\n\r\n    static RESULT_NONE = 99\r\n    static RESULT_BLACK_WIN = GameState.STONE_BLACK\r\n    static RESULT_WHITE_WIN = GameState.STONE_WHITE\r\n    static RESULT_DRAW = 0\r\n\r\n    static isBlackTurn(turn) {\r\n        return (turn % 2 === 0)\r\n    }\r\n\r\n    static getTurnColor(turn) {\r\n        return GameState.isBlackTurn(turn) ? GameState.STONE_BLACK : GameState.STONE_WHITE\r\n    }\r\n\r\n    constructor({boardSize}) {\r\n        this.boardSize = boardSize\r\n\r\n        this.turn = 0\r\n        this.result = GameState.RESULT_NONE\r\n        this.blackStones = new Array(boardSize * boardSize).fill(0)\r\n        this.whiteStones = new Array(boardSize * boardSize).fill(0)\r\n        this.history = []\r\n    }\r\n\r\n    clone() {\r\n        let newInstance = new GameState({ boardSize: this.boardSize })\r\n\r\n        newInstance.turn = this.turn\r\n        newInstance.result = this.result\r\n        newInstance.blackStones = this.blackStones.slice()\r\n        newInstance.whiteStones = this.whiteStones.slice()\r\n        newInstance.history = this.history.slice()\r\n\r\n        return newInstance\r\n    }\r\n\r\n    getValidPositions() {\r\n        let output = []\r\n\r\n        for (let i = 0; i < this.boardSize * this.boardSize; ++i) {\r\n            if (this.blackStones[i] === 0 && this.whiteStones[i] === 0) {\r\n                output.push([Math.floor(i / this.boardSize), i % this.boardSize])\r\n            }\r\n        }\r\n\r\n        return output\r\n    }\r\n\r\n    step(inputPos) {\r\n        let posIndex = inputPos[0] * this.boardSize + inputPos[1]\r\n\r\n        if (this.blackStones[posIndex] === 1 || this.whiteStones[posIndex] === 1) {\r\n            return false\r\n        }\r\n\r\n        if (GameState.isBlackTurn(this.turn)) {\r\n            this.blackStones[posIndex] = 1\r\n        } else {\r\n            this.whiteStones[posIndex] = 1\r\n        }\r\n\r\n        this.history.push(inputPos)\r\n        this.turn = this.turn + 1\r\n        this.result = this.checkResult(inputPos)\r\n\r\n        return true\r\n    }\r\n\r\n    undo() {\r\n        if (0 < this.turn) {\r\n            let lastPos = this.history[this.history.length - 1]\r\n            let lastPosIndex = lastPos[0] * this.boardSize + lastPos[1]\r\n\r\n            this.turn = this.turn - 1\r\n            this.blackStones[lastPosIndex] = 0\r\n            this.whiteStones[lastPosIndex] = 0\r\n            this.history.pop()\r\n\r\n            return true\r\n        }\r\n        else {\r\n            return false\r\n        }\r\n    }\r\n\r\n    checkResult(lastInputPos) {\r\n        let targetStones, targetResult\r\n        if (GameState.isBlackTurn(this.turn - 1)) {\r\n            targetStones = this.blackStones\r\n            targetResult = GameState.RESULT_BLACK_WIN\r\n        } else {\r\n            targetStones = this.whiteStones\r\n            targetResult = GameState.RESULT_WHITE_WIN\r\n        }\r\n\r\n        const winStoneCount = 5\r\n\r\n        // 가로 방향\r\n\t\t{\r\n\t\t\tlet row = lastInputPos[0]\r\n\t\t\tlet col = lastInputPos[1] - winStoneCount + 1\r\n\t\t\tlet sum = 0\r\n\t\t\tfor (let i = 0; i < winStoneCount * 2 - 1; ++i) {\r\n\t\t\t\tif (0 <= col && col < this.boardSize && targetStones[row*this.boardSize + col] === 1) {\r\n\t\t\t\t\tif (++sum === winStoneCount) {\r\n\t\t\t\t\t\treturn targetResult\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsum = 0\r\n\t\t\t\t}\r\n\r\n\t\t\t\t++col\r\n\t\t\t}\r\n        }\r\n        \r\n        // 세로방향\r\n\t\t{\r\n\t\t\tlet row = lastInputPos[0] - winStoneCount + 1\r\n\t\t\tlet col = lastInputPos[1]\r\n\t\t\tlet sum = 0\r\n\t\t\tfor (let i = 0; i < winStoneCount * 2 - 1; ++i) {\r\n\t\t\t\tif (0 <= row && row < this.boardSize && targetStones[row*this.boardSize + col] === 1) {\r\n\t\t\t\t\tif (++sum === winStoneCount) {\r\n\t\t\t\t\t\treturn targetResult\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsum = 0\r\n\t\t\t\t}\r\n\r\n\t\t\t\t++row\r\n\t\t\t}\t\t\t\r\n        }\r\n        \r\n        // 대각선 위 방향\r\n\t\t{\r\n\t\t\tlet row = lastInputPos[0] + winStoneCount - 1\r\n\t\t\tlet col = lastInputPos[1] - winStoneCount + 1\r\n\t\t\tlet sum = 0\r\n\t\t\tfor (let i = 0; i < winStoneCount * 2 - 1; ++i) {\r\n\t\t\t\tif (0 <= row && row < this.boardSize && 0 <= col && col < this.boardSize &&\r\n\t\t\t\t\ttargetStones[row*this.boardSize + col] === 1) {\r\n\r\n\t\t\t\t\tif (++sum === winStoneCount) {\r\n\t\t\t\t\t\treturn targetResult\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsum = 0\r\n\t\t\t\t}\r\n\r\n\t\t\t\t--row\r\n\t\t\t\t++col\r\n\t\t\t}\r\n        }\r\n        \r\n        // 대각선 아래 방향\r\n\t\t{\r\n\t\t\tlet row = lastInputPos[0] - winStoneCount + 1\r\n\t\t\tlet col = lastInputPos[1] - winStoneCount + 1\r\n\t\t\tlet sum = 0\r\n\t\t\tfor (let i = 0; i < winStoneCount * 2 - 1; ++i) {\r\n\t\t\t\tif (0 <= row && row < this.boardSize && 0 <= col && col < this.boardSize &&\r\n\t\t\t\t\ttargetStones[row*this.boardSize + col] === 1) {\r\n\r\n\t\t\t\t\tif (++sum === winStoneCount) {\r\n\t\t\t\t\t\treturn targetResult\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsum = 0\r\n\t\t\t\t}\r\n\r\n\t\t\t\t++row\r\n\t\t\t\t++col\r\n\t\t\t}\r\n        }\r\n        \r\n        // 비김\r\n        if (this.boardSize * this.boardSize <= this.turn) {\r\n            return GameState.RESULT_DRAW\r\n        }\r\n\r\n        return GameState.RESULT_NONE\r\n    }\r\n}\r\n\r\nexport default GameState","import React, { useEffect, useState } from 'react'\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles'\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Select from '@material-ui/core/Select'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport ComputerIcon from '@material-ui/icons/Computer'\r\nimport UndoIcon from '@material-ui/icons/Undo'\r\nimport ReplayIcon from '@material-ui/icons/Replay'\r\n\r\nimport Board from './Board'\r\nimport GameState from '../GameState'\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n    },\r\n    winningRatio: {\r\n        width: '200px',\r\n        height: '15px',\r\n        outlineStyle: 'solid',\r\n        outlineColor: 'black',\r\n        outlineWidth: 'thin',\r\n        determinate: {\r\n            color: 'red',\r\n        }\r\n    },\r\n    aiLevel: {\r\n        minWidth: '100px',\r\n    },\r\n})\r\n\r\nconst StyledLinearProgress = withStyles({\r\n    colorPrimary: {\r\n        backgroundColor: \"white\"\r\n    },\r\n    barColorPrimary: {\r\n        backgroundColor: \"black\"\r\n    }\r\n})(LinearProgress)\r\n\r\nexport default function Game({\r\n    gameState,\r\n    pvnet,\r\n    onSelect,\r\n    onRestart,\r\n    onUndo,\r\n    onComputer,\r\n    onAILevel,\r\n}) {\r\n    const [winningRatio, setWinningRatio] = useState(50)\r\n    const [policy, setPolicy] = useState([])\r\n    const [aiLevel, setAILevel] = useState(0)\r\n\r\n    useEffect(() => {\r\n        if (gameState.result === GameState.RESULT_BLACK_WIN) {\r\n            setWinningRatio(100)\r\n            setPolicy([])\r\n        } else if (gameState.result === GameState.RESULT_WHITE_WIN) {\r\n            setWinningRatio(0)\r\n            setPolicy([])\r\n        } else if (gameState.result === GameState.RESULT_DRAW) {\r\n            setWinningRatio(50)\r\n            setPolicy([])\r\n        } else if (0 < gameState.history.length) {\r\n            (async () => {\r\n                const modelInput = pvnet.getModelInput([gameState])\r\n                const modelOutput = await pvnet.asyncForward(modelInput)\r\n                if (modelOutput) {\r\n                    let policy = modelOutput.policies[0] \r\n                    let value = modelOutput.values[0]\r\n\r\n                    if (!GameState.isBlackTurn(gameState.turn)) {\r\n                        value *= -1.0\r\n                    }\r\n    \r\n                    value = Math.floor((value * 0.5 + 0.5) * 100)\r\n                    value = Math.min(Math.max(value, 1), 99)\r\n    \r\n                    setWinningRatio(value)\r\n                    setPolicy(policy)\r\n                }\r\n            })()\r\n        } else {\r\n            setPolicy([])\r\n        }\r\n\r\n        // eslint-disable-next-line\r\n    }, [gameState.history])\r\n\r\n    const classes = useStyles()\r\n    return (\r\n        <div className={classes.root}>\r\n            <Grid container justify='space-between' alignItems='center'>\r\n                <Grid item xs>\r\n                    {(0 < gameState.turn) && <StyledLinearProgress                   \r\n                        className={classes.winningRatio}\r\n                        variant=\"determinate\"\r\n                        value={winningRatio} \r\n                    />}\r\n                </Grid>\r\n                <Select\r\n                    className={classes.aiLevel} \r\n                    value={aiLevel}\r\n                    onChange={(e) => {setAILevel(e.target.value);onAILevel(e.target.value)}}>\r\n                    <MenuItem value={0}>Easy</MenuItem>\r\n                    <MenuItem value={1}>Medium</MenuItem>\r\n                    <MenuItem value={2}>Hard</MenuItem>\r\n                </Select>        \r\n                <Grid item>\r\n                    <Grid container justify='flex-end'>\r\n                        <IconButton size='small' onClick={() => onRestart()}>\r\n                            <ReplayIcon />\r\n                        </IconButton>\r\n                        <IconButton size='small' onClick={() => onUndo()}>\r\n                            <UndoIcon />\r\n                        </IconButton>\r\n                        <IconButton size='small' onClick={() => onComputer()}>\r\n                            <ComputerIcon />\r\n                        </IconButton>\r\n                    </Grid>\r\n                </Grid>\r\n            </Grid>\r\n            <Board\r\n                boardSize={gameState.boardSize}\r\n                history={gameState.history}\r\n                policy={policy}\r\n                onSelect={onSelect}/>\r\n        </div>\r\n    )\r\n}","import React from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Accordion from '@material-ui/core/Accordion'\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary'\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\n\r\nimport ReactMarkdown from 'react-markdown'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    root: {\r\n        width: '100%',\r\n    },\r\n    heading: {\r\n        fontSize: theme.typography.pxToRem(15),\r\n        fontWeight: theme.typography.fontWeightRegular,\r\n    },\r\n    linebreak: {\r\n        whiteSpace: 'pre-wrap',\r\n    }\r\n}))\r\n\r\nconst textWhatIsIt = `\r\n# AlphaOmok.js\r\n_2021.01.21 전형규(oasis@henjeon.com)_\r\n\r\n## 개요\r\n\r\n이 데모는 알파제로처럼 강화학습과 신경망을 사용하여 다음 수를 탐색하는 간단한 오목 게임으로,\r\n강화학습을 공부하면서 배운 내용을 실습하기 위한 목적으로 제작되었습니다. \r\n\\n\\n\r\n소스코드 및 자세한 설명은 [여기](https://github.com/henjeon/alpha-omok-js)에 있습니다.\r\n\r\n## 기능\r\n\r\n* 컴퓨터와 한 번씩 번갈아서 오목을 둘 수 있습니다. 모바일 기기에서도 잘 동작합니다.\r\n* 현재 대국 상태를 평가하여 어느 쪽이 유리한 지와 주요 착수점을 출력합니다.\r\n* AI의 난이도를 설정할 수 있습니다. 모바일 기기에서는 _HARD_ 난이도의 실행 속도가 너무 느리므로 선택하지 않는 것이 좋습니다.\r\n\r\n## 강화학습 방법\r\n\r\n약 4일 동안 40,000번의 selfplay를 통해 오목을 두는 법을 학습했습니다. 수의 탐색은 다른 오목 인공지능과 비슷하게 MCTS를 사용합니다.\r\n\r\n학습 속도를 단축하기 위해 멀티스레딩을 적극적으로 활용했습니다. pytorch 대신 libtorch로 모든 학습 코드를 구현했습니다. \r\n\r\n## 웹페이지에 올리기\r\n\r\nonnx.js를 사용해서 학습한 모델을 실행합니다. backend로는 _webgl_을 사용하며 wasm(web assembly)보다 세 배 정도 빠르게 동작합니다.\r\n\r\nui는 _react_와 _material-ui_를 사용하고 있습니다.\r\n\r\n모바일 기기에서도 실행가능하도록 MCTS 시뮬레이션 수를 크게 줄였습니다. 하나의 수를 탐색할 때 _EASY_ 난이도는 1번, _MEDIUM_ 난이도는 25번, _HARD_ 난이도는 400번의 시뮬레이션을 처리합니다.\r\n_HARD_ 난이도에서 수 하나를 찾는 시간은 PC에서 대략 30초가 걸립니다. 같은 설정으로 모바일 기기는 10배 이상 느리게 동작합니다.\r\n`\r\n\r\nconst textChangeLog = `\r\n\r\n### 2020.01.24\r\n\r\n* PC나 태블릿 같은 모바일 기기가 아닌 디바이스에서의 AI 탐색 성능을 개선했습니다. \r\n모바일 기기에서 이 기능을 활성화하려면 브라우저의 '데스크톱 사이트' 기능을 켜 보세요.\r\n\r\n* 바둑돌 위에 착수점 힌트가 표시되던 문제를 수정했습니다.\r\n* 다시 시작 후 바둑돌이 없는데 착수점 힌트가 표시되던 문제를 수정했습니다.\r\n\r\n### 2021.01.21\r\n\r\n* 최초 배포\r\n`\r\n\r\nexport default function SimpleExpansionPanel() {\r\n    const classes = useStyles()\r\n\r\n    return (\r\n        <div className={classes.root}>\r\n            <Accordion >\r\n                <AccordionSummary\r\n                    expandIcon={<ExpandMoreIcon />}\r\n                    aria-controls=\"panel1a-content\"\r\n                    id=\"panel1a-header\"\r\n                >\r\n                    <Typography className={classes.heading}>이게 뭔가요?</Typography>\r\n                </AccordionSummary>\r\n                <AccordionDetails>\r\n                    <div>\r\n                        <ReactMarkdown source={textWhatIsIt}/>\r\n                    </div>\r\n                </AccordionDetails>\r\n            </Accordion >\r\n            <Accordion >\r\n                <AccordionSummary\r\n                    expandIcon={<ExpandMoreIcon />}\r\n                    aria-controls=\"panel1a-content\"\r\n                    id=\"panel1a-header\"\r\n                >\r\n                    <Typography className={classes.heading}>변경점</Typography>\r\n                </AccordionSummary>\r\n                <AccordionDetails>\r\n                    <div>\r\n                        <ReactMarkdown source={textChangeLog}/>\r\n                    </div>\r\n                </AccordionDetails>\r\n            </Accordion >\r\n        </div>\r\n    )\r\n}\r\n","import { isMobileOnly as isMobileOnlyImported } from 'react-device-detect'\r\n\r\nconst isDevelopment = process.env.NODE_ENV && process.env.NODE_ENV === 'development'\r\nconst isMobileOnly = isMobileOnlyImported === true\r\n\r\nasync function sleep(seconds) {\r\n    return new Promise((resolve) => (setTimeout(resolve, seconds * 1000)))\r\n}\r\n\r\nexport { isDevelopment, isMobileOnly, sleep }","import GameState from './GameState'\r\nimport {sleep, isMobileOnly} from './Utils'\r\n\r\nclass ZeroAgent {\r\n    constructor({boardSize, pvnet}) {\r\n        this.boardSize = boardSize\r\n        this.pvnet = pvnet\r\n        this.level = 0\r\n        this.numSimulations = [1, 25, 400]\r\n    }\r\n\r\n    setLevel(level) {\r\n        this.level = level\r\n    }\r\n\r\n    async asyncGetAction(gameState) {\r\n        if (!this.pvnet.ready)\r\n        {\r\n            return\r\n        }\r\n\r\n        let rootNode = this.newNode()\r\n        let numSimulations = this.numSimulations[this.level] + 1\r\n\r\n        let inferences = []\r\n\r\n        for (let i = 0; i < numSimulations; ++i) {\r\n            let curGameState = gameState.clone()\r\n\r\n            await this.processInferences(inferences, this.level < 2 || numSimulations <= i + 4)\r\n\r\n            let leafNode = this.processSelection(rootNode, curGameState)\r\n            if (leafNode.result === GameState.RESULT_NONE) {\r\n                inferences.push([leafNode, curGameState])\r\n            } else {\r\n                this.processBackup(leafNode)\r\n            }            \r\n        }\r\n\r\n        await this.processInferences(inferences, true)\r\n\r\n        let maxVisitCount = -1\r\n        let bestNodeIndex\r\n        for (let i = 0; i < rootNode.children.length; ++i) {\r\n            let child = rootNode.children[i]\r\n            if (child && maxVisitCount < child.n) {\r\n                maxVisitCount = child.n\r\n                bestNodeIndex = i\r\n            }\r\n        }\r\n\r\n        return rootNode.childPositions[bestNodeIndex]\r\n    }\r\n\r\n    newNode() {\r\n        return {\r\n            children: [],\r\n            childPositions: [],\r\n            childPriors: [],\r\n            parent: null,\r\n            result: GameState.RESULT_NONE,\r\n            value: 0.0,\r\n            n: 0,\r\n            w: 0.0,\r\n            q: 0.0,\r\n            virtualLoss: 0.0,\r\n        }\r\n    }\r\n\r\n    async processInferences(inferences, force) {\r\n        if (inferences.length === 0) {\r\n            return\r\n        }\r\n\r\n        const maxInferenceQueueSize = isMobileOnly ? 1 : 4\r\n\r\n        if (force || maxInferenceQueueSize <= inferences.length) {\r\n            let modelInput = this.pvnet.getModelInput(inferences.reduce((a, e) => a.concat(e[1]), []))\r\n            let promise = this.pvnet.asyncForward(modelInput)\r\n            await sleep(0.01)  // ui가 갱신될 수 있도록 합니다.\r\n            let modelOutput = await promise\r\n\r\n            for (let i = 0; i < inferences.length; ++i) {\r\n                let [ leafNode, gameState ] = inferences[i]\r\n\r\n                this.processExpansionAndEvaluation(\r\n                    leafNode,\r\n                    gameState,\r\n                    modelOutput.policies[i],\r\n                    modelOutput.values[i])\r\n                this.processBackup(leafNode)\r\n            }\r\n\r\n            inferences.splice(0, inferences.length)\r\n        }\r\n    }\r\n\r\n    processSelection(rootNode, curGameState) {\r\n        let curNode = rootNode\r\n\r\n        while (0 < curNode.n) {\r\n            if (curNode.result !== GameState.RESULT_NONE) {\r\n                break\r\n            }\r\n\r\n            let totalNSquared = Math.sqrt(curNode.n)\r\n            \r\n            let maxQU = 0.0\r\n            let bestChildIndex = -1\r\n            for (let i = 0; i < curNode.children.length; ++i) {\r\n                let childNode = curNode.children[i]\r\n                let p = curNode.childPriors[i]\r\n                \r\n                let q = 0.0\r\n                let n = 0\r\n                let virtualLoss = 0.0\r\n                if (childNode) {\r\n                    q = childNode.q\r\n                    n = childNode.n\r\n                    virtualLoss = childNode.virtualLoss\r\n                }\r\n\r\n                const c_puct = 5\r\n                let u = c_puct * p * totalNSquared / (n + 1)\r\n                let qu = q + u - (virtualLoss / (n + 1))\r\n\r\n                if (bestChildIndex === -1 || maxQU < qu)\r\n                {\r\n                    maxQU = qu\r\n                    bestChildIndex = i\r\n                }\r\n            }\r\n\r\n            let bestChildNode = curNode.children[bestChildIndex]\r\n            if (!bestChildNode) {\r\n                bestChildNode = this.newNode()\r\n                bestChildNode.parent = curNode\r\n                curNode.children[bestChildIndex] = bestChildNode\r\n            }\r\n\r\n            curGameState.step(curNode.childPositions[bestChildIndex])\r\n            bestChildNode.result = curGameState.result\r\n            if (bestChildNode.result !== GameState.RESULT_NONE) {\r\n                bestChildNode.value = 1.0\r\n            }\r\n\r\n            curNode = bestChildNode\r\n            curNode.virtualLoss += 1.0\r\n        }\r\n\r\n        return curNode\r\n    }\r\n\r\n    processExpansionAndEvaluation(leafNode, curGameState, policy, value) {\r\n        if (0 < leafNode.children.length) {\r\n            return\r\n        }\r\n\r\n        let validPositions = curGameState.getValidPositions()\r\n        let numChildren = validPositions.length\r\n\r\n        leafNode.children = new Array(numChildren)\r\n        leafNode.childPositions = new Array(numChildren)\r\n        leafNode.childPriors = new Array(numChildren)\r\n\r\n        let sumOfP = 0.0\r\n        for (let i = 0; i < numChildren; ++i) {\r\n            let pos = validPositions[i]\r\n            let posIndex = pos[0] * this.boardSize + pos[1]\r\n\r\n            leafNode.childPositions[i] = pos\r\n            leafNode.childPriors[i] = policy[posIndex]\r\n            \r\n            sumOfP += policy[posIndex]\r\n        }\r\n\r\n        for (let i = 0; i < numChildren; ++i) {\r\n            leafNode.childPriors[i] /= sumOfP\r\n        }\r\n\r\n        leafNode.value = value * -1.0\r\n    }\r\n\r\n    processBackup(leafNode) {\r\n        let value = leafNode.value\r\n\r\n        let curNode = leafNode\r\n        while (curNode) {\r\n            curNode.n += 1\r\n            curNode.w += value\r\n            curNode.q = curNode.w / curNode.n\r\n            curNode.virtualLoss -= 1.0\r\n\r\n            curNode = curNode.parent\r\n            value *= -1.0\r\n        }\r\n    }\r\n}\r\n\r\nexport default ZeroAgent","import { Tensor, InferenceSession } from 'onnxjs'\r\n\r\nimport GameState from './GameState'\r\nimport { isMobileOnly } from './Utils'\r\n\r\nconst BATCH_SIZE = isMobileOnly ? 1 : 4\r\nconst NUM_INPUT_PLANES = 5\r\nconst HISTORY_SIZE = 5\r\n\r\nclass PVNet {\r\n    constructor({boardSize, modelPath}) {\r\n        this.boardSize = boardSize\r\n        this.modelPath = modelPath\r\n        this.ready = false\r\n    }\r\n\r\n    backendHint () {\r\n        if (this.ready) {\r\n            return this.model.session.backendHint\r\n        } else {\r\n            return '(not ready)'\r\n        }\r\n    }\r\n\r\n    async asyncLoadModel() {\r\n        const model = new InferenceSession({ backendHint: 'webgl' })\r\n\r\n        console.log(\"Loading model:\", this.modelPath)\r\n        await model.loadModel(this.modelPath)\r\n\r\n        console.log(\"Model warming up...\")\r\n        await model.run([\r\n            new Tensor(\r\n                new Float32Array(BATCH_SIZE * NUM_INPUT_PLANES * this.boardSize * this.boardSize),\r\n                'float32',\r\n                [BATCH_SIZE, NUM_INPUT_PLANES, this.boardSize, this.boardSize])   \r\n        ])\r\n\r\n        this.model = model\r\n        this.ready = true\r\n        console.log(\"Model was successfully loaded.\")\r\n    }\r\n\r\n    async asyncForward(input) {\r\n        if (!this.ready)\r\n        {\r\n            return\r\n        }\r\n\r\n        const batchSize = input.dims[0]\r\n        const planeSize = this.boardSize * this.boardSize\r\n        const modelOutput = await this.model.run([input])\r\n        const policyOutput = modelOutput.get('policy').data\r\n        const valueOutput = modelOutput.get('value').data\r\n\r\n        let policies = []\r\n        let values = []\r\n        for (let i = 0; i < batchSize; ++i) {\r\n            policies.push(policyOutput.slice(i * planeSize, (i + 1) * planeSize))\r\n            values.push(valueOutput[i])\r\n        }\r\n\r\n        return { policies: policies, values: values}\r\n    }\r\n\r\n    getModelInput(gameStates) {\r\n        let colorPlanes = Array(2)\r\n        colorPlanes[0] = (new Array(this.boardSize * this.boardSize)).fill(0)\r\n        colorPlanes[1] = (new Array(this.boardSize * this.boardSize)).fill(1)\r\n\r\n        let batchBuffer = []\r\n        for (let i = 0; i < gameStates.length; ++i) {\r\n            let gameState = gameStates[i]\r\n\r\n            let curTurn = gameState.turn\r\n            let curColor = GameState.getTurnColor(curTurn)\r\n            let oppColor = GameState.getTurnColor(curTurn + 1)\r\n\r\n            let curStones = curColor === GameState.STONE_BLACK ? gameState.blackStones : gameState.whiteStones\r\n            let oppStones = oppColor === GameState.STONE_BLACK ? gameState.blackStones : gameState.whiteStones\r\n\r\n            let curLastStones = new Array(this.boardSize * this.boardSize).fill(0)\r\n            let oppLastStones = new Array(this.boardSize * this.boardSize).fill(0)\r\n            for (let j = 0; j < HISTORY_SIZE * 2; ++j) {\r\n                let turn = (curTurn - 1) - j\r\n                if (0 <= turn) {\r\n                    let inputPos = gameState.history[turn]\r\n                    let lastStones = (j % 2) !== 0 ? curLastStones : oppLastStones\r\n                    lastStones[inputPos[0] * this.boardSize + inputPos[1]] = 1\r\n                }\r\n                else {\r\n                    break\r\n                }\r\n            }\r\n\r\n            batchBuffer = batchBuffer.concat(\r\n                curStones,\r\n                oppStones,\r\n                curLastStones,\r\n                oppLastStones,\r\n                colorPlanes[curTurn % 2])\r\n            if (i === gameStates.length - 1) {\r\n                for (let j = gameStates.length; j < BATCH_SIZE; ++j) {\r\n                    batchBuffer = batchBuffer.concat(\r\n                        colorPlanes[0],\r\n                        colorPlanes[0],\r\n                        colorPlanes[0],\r\n                        colorPlanes[0],\r\n                        colorPlanes[0])\r\n                }\r\n            }\r\n        }\r\n\r\n        return new Tensor(\r\n            batchBuffer,\r\n            'float32',\r\n            [BATCH_SIZE, NUM_INPUT_PLANES, this.boardSize, this.boardSize])\r\n    }\r\n}\r\n\r\nexport default PVNet","import 'fontsource-roboto'\r\n\r\nimport React, { useEffect, useState } from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport { AppBar } from '@material-ui/core'\r\nimport { Container }  from '@material-ui/core'\r\nimport { Toolbar } from '@material-ui/core'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Game from './components/Game'\r\nimport Readme from './components/Readme'\r\nimport GameState from './GameState'\r\nimport ZeroAgent from './ZeroAgent'\r\nimport PVNet from './PVNet'\r\nimport {isMobileOnly, isDevelopment, sleep} from './Utils'\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n        justifyContent:'center',\r\n        maxWidth: '100%',\r\n        margin: '5vh',\r\n    },\r\n    revision: {\r\n        justifyContent:'right',\r\n    }\r\n})\r\n\r\nconst BOARD_SIZE = 15\r\n\r\nconst AppState = {\r\n    DEFAULT: { text: \"\" },\r\n    MODEL_LOADING: { text: \"AI를 준비하고 있습니다. 잠시 기다려 주세요.\" },\r\n    WAITING_FOR_INPUT: { text: \"원하는 위치를 터치하거나 컴퓨터 아이콘을 누르세요.\" },\r\n    AGENT_THINKING: { text: \"AI가 다음 수를 계산하고 있습니다...\" },\r\n    GAME_FINISHED: { text: \"대국이 종료되었습니다. 다시 시작 버튼을 누르세요.\" }\r\n}\r\n\r\nfunction newGameState() {\r\n    return new GameState({\r\n        boardSize: BOARD_SIZE,\r\n    })\r\n}\r\n\r\nfunction App() {\r\n    const [appState, setAppState] = useState(AppState.DEFAULT)\r\n    const [gameState, setGameState] = useState(newGameState())\r\n    const [pvnet] = useState(new PVNet({\r\n        boardSize: BOARD_SIZE,\r\n        modelPath: './trained_model.onnx',\r\n    }))\r\n    const [zeroAgent] = useState(new ZeroAgent({\r\n        boardSize: BOARD_SIZE,\r\n        pvnet: pvnet,\r\n    }))\r\n\r\n    async function getComputerAction(curGameState) {\r\n        let startTime = performance.now()                \r\n        let pos = await zeroAgent.asyncGetAction(curGameState)        \r\n        let endTime = performance.now()\r\n        \r\n        setAiThinkTime(endTime - startTime)\r\n        \r\n        return pos\r\n    }\r\n\r\n    function goToNextState(curGameState, inputPos, autoPlay) {\r\n        let newGameState = curGameState.clone()\r\n        if (newGameState.step(inputPos)) {\r\n            setGameState(newGameState)\r\n\r\n            if (newGameState.result === GameState.RESULT_NONE) {\r\n                if (autoPlay) {\r\n                    (async () => {\r\n                        await sleep(1.0)\r\n                        let pos = await getComputerAction(newGameState)\r\n                        if (pos) {\r\n                            goToNextState(newGameState, pos)\r\n                        }\r\n                        else {\r\n                            console.warn(\"asyncGetAction() failed\")\r\n                        }\r\n                    })()\r\n                    setAppState(AppState.AGENT_THINKING)                    \r\n                } else {\r\n                    setAppState(AppState.WAITING_FOR_INPUT)\r\n                }\r\n            }\r\n            else {\r\n                setAppState(AppState.GAME_FINISHED)\r\n            }\r\n        }\r\n        else {\r\n            setAppState(AppState.WAITING_FOR_INPUT)\r\n        }\r\n    }\r\n\r\n    // componentDidMount()\r\n    useEffect(() => {\r\n        (async () => {\r\n            setAppState(AppState.MODEL_LOADING)\r\n            await pvnet.asyncLoadModel()\r\n\r\n            setAppState(AppState.WAITING_FOR_INPUT)\r\n        })()\r\n\r\n        // eslint-disable-next-line\r\n    }, [])\r\n\r\n    function onSelect(pos) {\r\n        if (appState === AppState.WAITING_FOR_INPUT) {\r\n            goToNextState(gameState, pos, true)\r\n        }\r\n    }\r\n\r\n    function onRestart() {\r\n        if (appState === AppState.WAITING_FOR_INPUT || appState === AppState.GAME_FINISHED) {\r\n            setGameState(newGameState())\r\n            setAppState(AppState.WAITING_FOR_INPUT)\r\n        }\r\n    }\r\n\r\n    function onUndo() {\r\n        if (appState === AppState.WAITING_FOR_INPUT || appState === AppState.GAME_FINISHED) {\r\n            let newGameState = gameState.clone()\r\n            if (newGameState.undo()) {\r\n                setGameState(newGameState)\r\n                setAppState(AppState.WAITING_FOR_INPUT)\r\n            }\r\n        }\r\n    }\r\n\r\n    function onComputer() {\r\n        if (appState === AppState.WAITING_FOR_INPUT) {\r\n            (async () => {\r\n                let pos = await getComputerAction(gameState)\r\n                if (pos) {\r\n                    goToNextState(gameState, pos)\r\n                }\r\n                else {\r\n                    console.warn(\"asyncGetAction() failed\")\r\n                }\r\n            })()\r\n            setAppState(AppState.AGENT_THINKING)\r\n        }\r\n    }\r\n\r\n    function onAILevel(aiLevel) {\r\n        zeroAgent.setLevel(aiLevel)\r\n    }\r\n\r\n    const [aiThinkTime, setAiThinkTime] = useState(0)\r\n    const debugText = `\r\nisMobileOnly: ${isMobileOnly}\r\nbackend: ${pvnet.backendHint()}\r\nwebgl.version: ${window.onnx.backend.webgl.glContext ? window.onnx.backend.webgl.glContext.version : 'undefined'}\r\naiThinkTime: ${aiThinkTime * 0.001}s`\r\n\r\n    const classes = useStyles()\r\n    return (\r\n        <div>\r\n            <AppBar position=\"static\">\r\n                <Toolbar >\r\n                    <Grid container justify='space-between'>\r\n                        <Typography variant='h6'>\r\n                            AlphaOmok.js\r\n                        </Typography>\r\n                        <Typography variant='caption'>\r\n                            v0.1.1\r\n                        </Typography>\r\n                    </Grid>\r\n                </Toolbar>\r\n            </AppBar>\r\n            <Container>\r\n                { isDevelopment && <div style={{whiteSpace:\"pre\"}}> {debugText}</div> }\r\n                <Grid className={classes.root} container>\r\n                    <Grid item>\r\n                        <Game\r\n                            gameState={gameState}\r\n                            pvnet={pvnet}\r\n                            onSelect={onSelect}\r\n                            onRestart={onRestart}\r\n                            onUndo={onUndo}\r\n                            onComputer={onComputer}\r\n                            onAILevel={onAILevel}>\r\n                        </Game>\r\n                        <Typography color=\"textPrimary\">\r\n                            {appState.text}\r\n                        </Typography>\r\n                    </Grid>\r\n                </Grid>\r\n                <Readme/>\r\n            </Container>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default App\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}